#include "assembler_p_impl.h"

#include "geek/utils/debug.h"

namespace geek {
namespace internal {
Mem::Impl::Impl(asmjit::x86::Mem&& m) 
	: mem_(std::move(m))
{
}

Label::Impl::Impl(asmjit::Label&& m)
	: label_(std::move(m))
{
}

namespace {
template<class T>
std::unique_ptr<T> AllocReg(const T& copy)
{
	return std::make_unique<T>(copy);
}

}

#define REG2ASMJIT(r) \
	case RegisterId::r: reg_ = AllocReg(asmjit::x86::r); break

Reg::Impl::Impl(RegisterId id)
{
	switch (id)
	{
		REG2ASMJIT(al);
		REG2ASMJIT(bl);
		REG2ASMJIT(cl);
		REG2ASMJIT(dl);
		REG2ASMJIT(spl);
		REG2ASMJIT(bpl);
		REG2ASMJIT(sil);
		REG2ASMJIT(dil);
		REG2ASMJIT(r8b);
		REG2ASMJIT(r9b);
		REG2ASMJIT(r10b);
		REG2ASMJIT(r11b);
		REG2ASMJIT(r12b);
		REG2ASMJIT(r13b);
		REG2ASMJIT(r14b);
		REG2ASMJIT(r15b);

		REG2ASMJIT(ah);
		REG2ASMJIT(bh);
		REG2ASMJIT(ch);
		REG2ASMJIT(dh);

		REG2ASMJIT(ax);
		REG2ASMJIT(bx);
		REG2ASMJIT(cx);
		REG2ASMJIT(dx);
		REG2ASMJIT(sp);
		REG2ASMJIT(bp);
		REG2ASMJIT(si);
		REG2ASMJIT(di);
		REG2ASMJIT(r8w);
		REG2ASMJIT(r9w);
		REG2ASMJIT(r10w);
		REG2ASMJIT(r11w);
		REG2ASMJIT(r12w);
		REG2ASMJIT(r13w);
		REG2ASMJIT(r14w);
		REG2ASMJIT(r15w);

		REG2ASMJIT(eax);
		REG2ASMJIT(ebx);
		REG2ASMJIT(ecx);
		REG2ASMJIT(edx);
		REG2ASMJIT(esp);
		REG2ASMJIT(ebp);
		REG2ASMJIT(esi);
		REG2ASMJIT(edi);
		REG2ASMJIT(r8d);
		REG2ASMJIT(r9d);
		REG2ASMJIT(r10d);
		REG2ASMJIT(r11d);
		REG2ASMJIT(r12d);
		REG2ASMJIT(r13d);
		REG2ASMJIT(r14d);
		REG2ASMJIT(r15d);

		REG2ASMJIT(rax);
		REG2ASMJIT(rbx);
		REG2ASMJIT(rcx);
		REG2ASMJIT(rdx);
		REG2ASMJIT(rsp);
		REG2ASMJIT(rbp);
		REG2ASMJIT(rsi);
		REG2ASMJIT(rdi);
		REG2ASMJIT(r8);
		REG2ASMJIT(r9);
		REG2ASMJIT(r10);
		REG2ASMJIT(r11);
		REG2ASMJIT(r12);
		REG2ASMJIT(r13);
		REG2ASMJIT(r14);
		REG2ASMJIT(r15);

		REG2ASMJIT(xmm0);
		REG2ASMJIT(xmm1);
		REG2ASMJIT(xmm2);
		REG2ASMJIT(xmm3);
		REG2ASMJIT(xmm4);
		REG2ASMJIT(xmm5);
		REG2ASMJIT(xmm6);
		REG2ASMJIT(xmm7);
		REG2ASMJIT(xmm8);
		REG2ASMJIT(xmm9);
		REG2ASMJIT(xmm10);
		REG2ASMJIT(xmm11);
		REG2ASMJIT(xmm12);
		REG2ASMJIT(xmm13);
		REG2ASMJIT(xmm14);
		REG2ASMJIT(xmm15);
		REG2ASMJIT(xmm16);
		REG2ASMJIT(xmm17);
		REG2ASMJIT(xmm18);
		REG2ASMJIT(xmm19);
		REG2ASMJIT(xmm20);
		REG2ASMJIT(xmm21);
		REG2ASMJIT(xmm22);
		REG2ASMJIT(xmm23);
		REG2ASMJIT(xmm24);
		REG2ASMJIT(xmm25);
		REG2ASMJIT(xmm26);
		REG2ASMJIT(xmm27);
		REG2ASMJIT(xmm28);
		REG2ASMJIT(xmm29);
		REG2ASMJIT(xmm30);
		REG2ASMJIT(xmm31);

		REG2ASMJIT(ymm0);
		REG2ASMJIT(ymm1);
		REG2ASMJIT(ymm2);
		REG2ASMJIT(ymm3);
		REG2ASMJIT(ymm4);
		REG2ASMJIT(ymm5);
		REG2ASMJIT(ymm6);
		REG2ASMJIT(ymm7);
		REG2ASMJIT(ymm8);
		REG2ASMJIT(ymm9);
		REG2ASMJIT(ymm10);
		REG2ASMJIT(ymm11);
		REG2ASMJIT(ymm12);
		REG2ASMJIT(ymm13);
		REG2ASMJIT(ymm14);
		REG2ASMJIT(ymm15);
		REG2ASMJIT(ymm16);
		REG2ASMJIT(ymm17);
		REG2ASMJIT(ymm18);
		REG2ASMJIT(ymm19);
		REG2ASMJIT(ymm20);
		REG2ASMJIT(ymm21);
		REG2ASMJIT(ymm22);
		REG2ASMJIT(ymm23);
		REG2ASMJIT(ymm24);
		REG2ASMJIT(ymm25);
		REG2ASMJIT(ymm26);
		REG2ASMJIT(ymm27);
		REG2ASMJIT(ymm28);
		REG2ASMJIT(ymm29);
		REG2ASMJIT(ymm30);
		REG2ASMJIT(ymm31);

		REG2ASMJIT(zmm0);
		REG2ASMJIT(zmm1);
		REG2ASMJIT(zmm2);
		REG2ASMJIT(zmm3);
		REG2ASMJIT(zmm4);
		REG2ASMJIT(zmm5);
		REG2ASMJIT(zmm6);
		REG2ASMJIT(zmm7);
		REG2ASMJIT(zmm8);
		REG2ASMJIT(zmm9);
		REG2ASMJIT(zmm10);
		REG2ASMJIT(zmm11);
		REG2ASMJIT(zmm12);
		REG2ASMJIT(zmm13);
		REG2ASMJIT(zmm14);
		REG2ASMJIT(zmm15);
		REG2ASMJIT(zmm16);
		REG2ASMJIT(zmm17);
		REG2ASMJIT(zmm18);
		REG2ASMJIT(zmm19);
		REG2ASMJIT(zmm20);
		REG2ASMJIT(zmm21);
		REG2ASMJIT(zmm22);
		REG2ASMJIT(zmm23);
		REG2ASMJIT(zmm24);
		REG2ASMJIT(zmm25);
		REG2ASMJIT(zmm26);
		REG2ASMJIT(zmm27);
		REG2ASMJIT(zmm28);
		REG2ASMJIT(zmm29);
		REG2ASMJIT(zmm30);
		REG2ASMJIT(zmm31);

		REG2ASMJIT(mm0);
		REG2ASMJIT(mm1);
		REG2ASMJIT(mm2);
		REG2ASMJIT(mm3);
		REG2ASMJIT(mm4);
		REG2ASMJIT(mm5);
		REG2ASMJIT(mm6);
		REG2ASMJIT(mm7);

		REG2ASMJIT(k0);
		REG2ASMJIT(k1);
		REG2ASMJIT(k2);
		REG2ASMJIT(k3);
		REG2ASMJIT(k4);
		REG2ASMJIT(k5);
		REG2ASMJIT(k6);
		REG2ASMJIT(k7);

		REG2ASMJIT(no_seg);
		REG2ASMJIT(es);
		REG2ASMJIT(cs);
		REG2ASMJIT(ss);
		REG2ASMJIT(ds);
		REG2ASMJIT(fs);
		REG2ASMJIT(gs);

		REG2ASMJIT(cr0);
		REG2ASMJIT(cr1);
		REG2ASMJIT(cr2);
		REG2ASMJIT(cr3);
		REG2ASMJIT(cr4);
		REG2ASMJIT(cr5);
		REG2ASMJIT(cr6);
		REG2ASMJIT(cr7);
		REG2ASMJIT(cr8);
		REG2ASMJIT(cr9);
		REG2ASMJIT(cr10);
		REG2ASMJIT(cr11);
		REG2ASMJIT(cr12);
		REG2ASMJIT(cr13);
		REG2ASMJIT(cr14);
		REG2ASMJIT(cr15);

		REG2ASMJIT(dr0);
		REG2ASMJIT(dr1);
		REG2ASMJIT(dr2);
		REG2ASMJIT(dr3);
		REG2ASMJIT(dr4);
		REG2ASMJIT(dr5);
		REG2ASMJIT(dr6);
		REG2ASMJIT(dr7);
		REG2ASMJIT(dr8);
		REG2ASMJIT(dr9);
		REG2ASMJIT(dr10);
		REG2ASMJIT(dr11);
		REG2ASMJIT(dr12);
		REG2ASMJIT(dr13);
		REG2ASMJIT(dr14);
		REG2ASMJIT(dr15);

		REG2ASMJIT(st0);
		REG2ASMJIT(st1);
		REG2ASMJIT(st2);
		REG2ASMJIT(st3);
		REG2ASMJIT(st4);
		REG2ASMJIT(st5);
		REG2ASMJIT(st6);
		REG2ASMJIT(st7);

		REG2ASMJIT(bnd0);
		REG2ASMJIT(bnd1);
		REG2ASMJIT(bnd2);
		REG2ASMJIT(bnd3);

		REG2ASMJIT(tmm0);
		REG2ASMJIT(tmm1);
		REG2ASMJIT(tmm2);
		REG2ASMJIT(tmm3);
		REG2ASMJIT(tmm4);
		REG2ASMJIT(tmm5);
		REG2ASMJIT(tmm6);
		REG2ASMJIT(tmm7);

		REG2ASMJIT(rip);
	default:
		GEEK_ASSERT(false, "Unknow register id:", static_cast<uint32_t>(id));
	}
}
}
}
